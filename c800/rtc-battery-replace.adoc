---
permalink: c800/rtc-battery-replace.html 
sidebar: sidebar 
keywords: aff c800, replace the real-time clock battery 
summary: 您可以更換控制器模組中的即時時鐘（RTc）電池、讓系統的服務和應用程式繼續運作、而這些服務和應用程式必須仰賴精確的時間同步。 
---
= 更換即時時鐘電池AFF - Real-Time C800
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
更換AFF C800系統中的即時時鐘 (RTC) 電池（通常稱為紐扣電池），以確保依賴精確時間同步的服務和應用程式能夠繼續運作。

.開始之前
* 瞭解您可以將此程序用於系統支援的所有 ONTAP 版本。
* 請確定系統中的所有其他元件都正常運作；如果沒有、您必須聯絡技術支援部門。




== 步驟1：關閉受損的控制器

關閉或接管受損的控制器。

若要關閉受損的控制器、您必須判斷控制器的狀態、並在必要時接管控制器、以便健全的控制器繼續從受損的控制器儲存設備提供資料。

.關於這項工作
* 如果您有 SAN 系統，則必須檢查故障控制器 SCSI 刀鋒的事件訊息  `cluster kernel-service show`。 `cluster kernel-service show`命令（從 priv 進階模式）會顯示節點名稱、link:https://docs.netapp.com/us-en/ontap/system-admin/display-nodes-cluster-task.html["仲裁狀態"]該節點的可用度狀態、以及該節點的作業狀態。
+
每個SCSI刀鋒處理序都應與叢集中的其他節點處於仲裁狀態。任何問題都必須先解決、才能繼續進行更換。

* 如果叢集有兩個以上的節點、則叢集必須處於仲裁狀態。如果叢集未達到法定人數、或健全的控制器顯示為「假」、表示符合資格和健全狀況、則您必須在關閉受損的控制器之前修正問題；請參閱 link:https://docs.netapp.com/us-en/ontap/system-admin/synchronize-node-cluster-task.html?q=Quorum["將節點與叢集同步"^]。


.步驟
. 如果啟用了「支援」功能、請叫用下列消息來禁止自動建立個案AutoSupport AutoSupport ：
+
`system node autosupport invoke -node * -type all -message MAINT=<# of hours>h`

+
下列AutoSupport 資訊不顯示自動建立案例兩小時：

+
`cluster1:> system node autosupport invoke -node * -type all -message MAINT=2h`

. 停用自動交還：
+
.. 從健康控制器的控制台輸入以下命令：
+
`storage failover modify -node _impaired_node_name_ -auto-giveback false`

.. 進入 `y`當您看到提示「您是否要停用自動回饋？」時


. 將受損的控制器移至載入器提示：
+
[cols="1,2"]
|===
| 如果受損的控制器正在顯示... | 然後... 


 a| 
載入程式提示
 a| 
前往下一步。



 a| 
正在等待恢復...
 a| 
按Ctrl-C、然後在出現提示時回應「y」。



 a| 
系統提示或密碼提示
 a| 
從健全的控制器接管或停止受損的控制器：

`storage failover takeover -ofnode _impaired_node_name_ -halt _true_`

--halt true_ 參數會帶您進入 Loader 提示字元。

|===




== 步驟2：移除控制器模組

更換控制器模組或更換控制器模組內部的元件時、您必須從機箱中移除控制器模組。

.步驟
. 如果您尚未接地、請正確接地。
. 請用拇指推動每個磁碟機，直到您感覺到正向停止為止，以確保機箱中的所有磁碟機都穩固地安裝在中間背板上。
+
.影片 - 確認駕駛座椅
video::2c46e4af-2c21-4f12-b065-b38b003d0ea2[panopto]
+
image::../media/drw_a800_drive_seated_IEOPS-960.svg[將驅動器安裝到位]

. 根據系統狀態檢查控制器驅動器：
+
.. 在運作正常的控制器上，檢查是否有任何處於降級狀態、故障狀態或兩者兼具的狀態：
+
[source, cli]
----
storage aggregate show -raidstatus !*normal*
----
+
*** 如果命令返回 `There are no entries matching your query.`繼續<<Check-missing-drives,進入下一個子步驟，檢查是否有缺少的驅動器。>>。
*** 如果該命令返回任何其他結果，請從兩個控制器收集AutoSupport數據，並聯絡NetApp支援部門以取得進一步協助。
+
[source, cli]
----
system node autosupport invoke -node * -type all -message '<message_name>'
----


.. [[檢查缺少磁碟機]]檢查檔案系統或備用磁碟機是否有缺失磁碟機問題：
+
[source, cli]
----
event log show -severity * -node * -message-name *disk.missing*
----
+
*** 如果命令返回 `There are no entries matching your query.`繼續<<remove-power-cables,進入下一步>>。
*** 如果該命令返回任何其他結果，請從兩個控制器收集AutoSupport數據，並聯絡NetApp支援部門以取得進一步協助。
+
[source, cli]
----
system node autosupport invoke -node * -type all -message '<message_name>'
----




. [[移除電源線]]移除電源線固定器，然後從電源上拔下電源線。
. 鬆開線纜管理裝置上的魔鬼氈綁帶。從控制器模組上拔下系統電纜和 SFP/QSFP 模組（如果需要）。記下每條電纜的位置。
+
將纜線留在纜線管理裝置中、以便在重新安裝纜線管理裝置時、整理好纜線。

. 從控制器模組中取出纜線管理裝置、然後將其放在一旁。
. 向下按兩個鎖定栓、然後同時向下轉動兩個鎖條。
+
控制器模組會稍微移出機箱。

+
image::../media/drw_a800_pcm_remove.png[卸下控制器模組]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["編號 1"]
 a| 
鎖定鎖定



 a| 
image:../media/icon_round_2.png["編號 2"]
 a| 
鎖定銷

|===
. 將控制器模組滑出機箱、然後放在穩固的平面上。
+
托住控制器模組的底部，將其從機箱中滑出。





== 步驟3：更換RTC電池

更換即時時鐘電池。

更換 RTC 電池的步驟因控制器是原版還是 VER2 型號而異。請使用下面的選項卡選擇適合您控制器型號的說明。

.關於這項工作
在第一代控制器上，電池位於 Riser 2（中間的 Riser）下方；在 VER2 控制器上，電池位於 DIMM 附近。

[role="tabbed-block"]
====
.原始控制器
--
.步驟
. 從控制器模組中移除 PCIe 提升板 2 （中間提升板）：
+
.. 移除PCIe卡中的任何SFP或QSFP模組。
.. 向上轉動提升板左側的提升板鎖定栓、並朝風扇模組方向轉動。
+
提升板會從控制器模組稍微向上提升。

.. 向上提起提升板、將其移向風扇、使提升板上的金屬片邊緣脫離控制器模組邊緣、將提升板從控制器模組中提出、然後將其放置在穩固的平面上。
+
image::../media/drw_a800_riser_2_3_remove.png[卸下提升板 2]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["編號 1"]
 a| 
通風管



 a| 
image:../media/icon_round_2.png["編號 2"]
 a| 
擴充卡2（中間擴充卡）鎖定栓

|===


. 在提升板2下找到RTC電池。
+
image::../media/drw_a800_rtc_battery_replace.png[移除並更換 RTC 電池]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["編號 1"]
 a| 
通風管



 a| 
image:../media/icon_round_2.png["編號 2"]
 a| 
擴充卡2



 a| 
image:../media/icon_round_3.png["編號 3"]
 a| 
RTC電池與外殼

|===
. 將電池從電池座中輕推、將電池從電池座中轉開、然後將其從電池座中取出。
+

NOTE: 從電池座取出電池時、請注意電池的極性。電池標有加號、必須正確放置在電池座中。支架附近的加號表示電池的放置方式。

. 從防靜電包裝袋中取出替換電池。
. 記下RTC電池的極性、然後以一定角度向下推電池、將其插入電池座。
. 目視檢查電池、確定電池已完全裝入電池座、且極性正確。
. 將擴充卡安裝至控制器模組：
+
.. 將擴充卡的邊緣對齊控制器模組的底部金屬板。
.. 沿控制器模組的插腳引導擴充卡、然後將擴充卡降低至控制器模組。
.. 向下轉動鎖定栓、然後將其卡入鎖定位置。
+
鎖定時、鎖定栓會與擴充卡的頂端齊平、而擴充卡則會正面置於控制器模組中。

.. 重新插入從PCIe卡中移除的任何SFP模組。




--
.Ver2 控制器
--
.步驟
. 找到 DIMM 附近的 RTC 電池。
+
image::../media/drw_a800_rtc_battery_replace_v2.png[取出並更換 RTC 電池]

+
[cols="1,4"]
|===


 a| 
image:../media/icon_round_1.png["編號 1"]
 a| 
通風管



 a| 
image:../media/icon_round_2.png["編號 2"]
 a| 
RTC電池與外殼

|===
. 將電池從電池座中輕推、將電池從電池座中轉開、然後將其從電池座中取出。
+

NOTE: 從電池座取出電池時、請注意電池的極性。電池標有加號、必須正確放置在電池座中。支架附近的加號表示電池的放置方式。

. 從防靜電包裝袋中取出替換電池。
. 記下RTC電池的極性、然後以一定角度向下推電池、將其插入電池座。
. 目視檢查電池、確定電池已完全裝入電池座、且極性正確。


--
====


== 步驟4：重新安裝控制器模組

重新安裝控制器模組、然後重新啟動。

.步驟
. 將控制器模組的一端與機箱的開口對齊、然後將控制器模組輕推至系統的一半。
+

NOTE: 在指示之前、請勿將控制器模組完全插入機箱。

. 視需要重新安裝系統。
+
如果您移除媒體轉換器（QSFP或SFP）、請記得在使用光纖纜線時重新安裝。

. 完成控制器模組的重新安裝：
+
.. 將控制器模組穩固地推入機箱、直到它與中間板完全接入。
+
控制器模組完全就位時、鎖定鎖條會上升。

+

NOTE: 將控制器模組滑入機箱時、請勿過度施力、以免損壞連接器。

.. 向上轉動鎖定栓、將其傾斜、使其從鎖定銷中取出、然後將其放低至鎖定位置。
.. 將電源線插入電源供應器，重新安裝電源線鎖環，然後將電源供應器連接至電源。
+
控制器模組會在電源恢復後立即開始開機。準備好中斷開機程序。

.. 如果您尚未重新安裝纜線管理裝置、請重新安裝。


. 將受損的控制器歸還其儲存設備、使其恢復正常運作：
+
`storage failover giveback -ofnode _impaired_node_name_`。

. 如果自動恢復已停用、請重新啟用：
+
`storage failover modify -node local -auto-giveback true`。

. 如果啟用 AutoSupport ，則還原 / 恢復自動建立個案：
+
`system node autosupport invoke -node * -type all -message MAINT=END`。





== 步驟5：將故障零件歸還給NetApp

如套件隨附的RMA指示所述、將故障零件退回NetApp。如 https://mysupport.netapp.com/site/info/rma["零件退貨與更換"]需詳細資訊、請參閱頁面。
