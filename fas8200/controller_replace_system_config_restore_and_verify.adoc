---
permalink: fas8200/controller-replace-system-config-restore-and-verify.html 
sidebar: sidebar 
keywords: fas8200, restore and verify the system configuration, verify and set the ha state of the controller module, run system-level diagnostics 
summary: 完成硬體更換並開機至維護模式之後、您需要驗證更換控制器的低階系統組態、並視需要重新設定系統設定。 
---
= 還原並驗證系統組態- FAS8200
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
完成硬體更換並開機至維護模式之後、您需要驗證更換控制器的低階系統組態、並視需要重新設定系統設定。



== 步驟1：更換控制器後、請設定並驗證系統時間

您應該對照HA配對中的健全控制器模組、或獨立組態中的可靠時間伺服器、檢查更換控制器模組的時間和日期。如果時間和日期不相符、您必須在更換的控制器模組上重設、以避免客戶端因時間差異而可能發生中斷。

請務必在正確的系統上套用步驟中的命令：

* _replaced_節點是新的節點、在本程序中會取代受損節點。
* _Healthy節點是_replace_節點的HA合作夥伴。


.步驟
. 如果_replacem__節點未出現在載入程式提示字元、請停止系統並顯示載入程式提示字元。
. 在_Healthy節點上、檢查系統時間：「How date（顯示日期）」
+
日期與時間以GMT.為準。

. 在載入程式提示下、檢查_replacement節點上的日期和時間：「How date（顯示日期）」
+
日期與時間以GMT.為準。

. 如有必要、請在替換節點上設定以GMT0為單位的日期：「et date _mm/dd/ymm_'（設定日期_月/日/西元年_）」
. 如有必要、請在替換節點上設定以GMT0為單位的時間：「et time _hh：mm:ss_」（設定時間_hh：mm：ss_）
. 在載入程式提示下、確認_replaced_節點上的日期和時間：「How date（顯示日期）」
+
日期與時間以GMT.為準。





== 步驟2：驗證並設定控制器模組的HA狀態

您必須驗證控制器模組的「HA」狀態、並視需要更新狀態以符合您的系統組態。

. 在新控制器模組的維護模式中、確認所有元件都顯示相同的「HA」狀態：「ha-config show」
+
所有元件的HA狀態都應該相同。

. 如果顯示的控制器模組系統狀態與您的系統組態不符、請設定控制器模組的「HA」狀態：「ha-config modify controller ha-state」
+
HA狀態的值可以是下列其中一項：

+
** 《哈》
** "Malc"
** 「抄送給我們」
** 《MCCIP》
** 「非哈」


. 如果顯示的控制器模組系統狀態與您的系統組態不符、請設定控制器模組的「HA」狀態：「ha-config modify controller ha-state」
. 確認設定已變更：「ha-config show」




== 步驟3：執行系統層級診斷

您應該在更換控制器時、針對特定元件和子系統執行全方位或集中的診斷測試。

診斷程序中的所有命令都是由要更換元件的控制器發出。

. 如果要維修的控制器未出現載入程式提示、請重新啟動控制器：「halt（停止）」
+
發出命令之後、您應該等到系統在載入程式提示字元停止。

. 在載入程式提示字元下、存取專為系統層級診斷所設計的特殊驅動程式、以正常運作：「boot_diags'（boot_diags'）
+
在開機過程中、您可以安全地回應提示「y」、直到出現「維護模式」提示（*>）為止。

. 顯示並記下控制器模組上的可用裝置：「ldiag設備show -devMB」
+
顯示的控制器模組裝置和連接埠可以是下列任一或多個項目：

+
** 「bootmedia」是系統開機裝置。
** CNA是整合式網路介面卡、或是未連線至網路或儲存設備的介面。
** FCAL是未連接至光纖通道網路的光纖通道仲裁迴圈裝置。
** 「env」是主機板環境。
** 記憶體是系統記憶體。
** NIC是一種網路介面卡。
** NVRAM是非易失性RAM。
** 「nvmem」是NVRAM與系統記憶體的混合體。
** 「AS」是未連接至磁碟櫃的序列連接SCSI裝置。


. 視需要執行診斷。
+
[cols="1,2"]
|===
| 如果您要在...上執行診斷測試 | 然後... 


 a| 
個別元件
 a| 
.. 清除狀態記錄：「ldiag」裝置的清除狀態
.. 顯示所選裝置的可用測試：「ldiag設備show -dev_name_」
+
_dev_name_可以是上一步中識別的任何一個連接埠和裝置。

.. 檢查輸出、如果適用、請僅選取您要執行的測試：「ldiag設備modify -dev_name_-selection only」（僅限ldiag設備修改-dev_dev_name_選擇）
+
-selection只會停用您不想為裝置執行的所有其他測試。

.. 執行選取的測試：「ldiag裝置執行-dev_name_」
+
測試完成後、會顯示下列訊息：

+
[listing]
----
*> <SLDIAG:_ALL_TESTS_COMPLETED>
----
.. 確認沒有測試失敗：「ldiag設備狀態-dev_dev_name_-long -stStatus fAILED」
+
如果沒有測試失敗、系統層級的診斷會返回提示、或列出測試元件所導致的故障完整狀態。





 a| 
同時提供多個元件
 a| 
.. 檢閱上述程序輸出中已啟用和已停用的裝置、並判斷您要同時執行的裝置。
.. 列出裝置的個別測試：「ldiag設備show -dev_name_」
.. 檢查輸出、如果適用、請僅選取您要執行的測試：「ldiag設備modify -dev_name_-selection only」（僅限ldiag設備修改-dev_dev_name_選擇）
+
-selection只會停用您不想為裝置執行的所有其他測試。

.. 驗證測試是否已修改：「ldiag device show」
.. 針對您要同時執行的每個裝置重複這些子步驟。
.. 在所有裝置上執行診斷：「ldiag device run」（執行ldiag裝置）
+

NOTE: 開始執行診斷後、請勿新增或修改您的項目。

+
測試完成後、會顯示下列訊息：

+
[listing]
----
*> <SLDIAG:_ALL_TESTS_COMPLETED>
----
.. 驗證控制器上是否存在硬體問題：「ldiag設備狀態-long -state f失敗」
+
如果沒有測試失敗、系統層級的診斷會返回提示、或列出測試元件所導致的故障完整狀態。



|===
. 請根據上述步驟的結果繼續進行。
+
[cols="1,2"]
|===
| 如果系統層級的診斷測試... | 然後... 


 a| 
已完成、沒有任何故障
 a| 
.. 清除狀態記錄：「ldiag」裝置的清除狀態
.. 確認記錄已清除：「ldiag設備狀態」
+
畫面會顯示下列預設回應：

+
[listing]
----
SLDIAG: No log messages are present.
----
.. 退出維護模式：「halt」
+
系統會顯示載入程式提示。

+
您已完成系統層級的診斷。





 a| 
導致某些測試失敗
 a| 
確定問題的原因。

.. 退出維護模式：「halt」
.. 執行乾淨關機、然後拔下電源供應器。
.. 確認您已注意到執行系統層級診斷所需的所有考量事項、纜線是否穩固連接、以及硬體元件是否已正確安裝在儲存系統中。
.. 重新連接電源供應器、然後開啟儲存系統電源。
.. 重新執行系統層級的診斷測試。


|===

